<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to Data Science - 8&nbsp; Visualization</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./statsmod.html" rel="next">
<link href="./eda.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./visualization.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Visualization</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./images/ids-s24.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Data Science</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preliminaries</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./git.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Project Management</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Reproducibile Data Science</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Python Refreshment</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Import/Export</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./communication.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Communicating Data Science</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visualization.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Visualization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./statsmod.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Statistical Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./supervised.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Supervised Learning</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#data-visualization-with-matplotlib" id="toc-data-visualization-with-matplotlib" class="nav-link active" data-scroll-target="#data-visualization-with-matplotlib"><span class="header-section-number">8.1</span> Data Visualization with <code>matplotlib</code></a>
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="header-section-number">8.1.1</span> Introduction</a></li>
  <li><a href="#matplotlib" id="toc-matplotlib" class="nav-link" data-scroll-target="#matplotlib"><span class="header-section-number">8.1.2</span> Matplotlib</a></li>
  <li><a href="#example-with-rodent-data" id="toc-example-with-rodent-data" class="nav-link" data-scroll-target="#example-with-rodent-data"><span class="header-section-number">8.1.3</span> Example with rodent data:</a></li>
  <li><a href="#pandas" id="toc-pandas" class="nav-link" data-scroll-target="#pandas"><span class="header-section-number">8.1.4</span> Pandas</a></li>
  <li><a href="#seaborn" id="toc-seaborn" class="nav-link" data-scroll-target="#seaborn"><span class="header-section-number">8.1.5</span> Seaborn</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">8.1.6</span> Conclusion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">8.1.7</span> References</a></li>
  </ul></li>
  <li><a href="#grammar-of-graphics-with-plotnine" id="toc-grammar-of-graphics-with-plotnine" class="nav-link" data-scroll-target="#grammar-of-graphics-with-plotnine"><span class="header-section-number">8.2</span> Grammar of Graphics with <code>Plotnine</code></a>
  <ul class="collapse">
  <li><a href="#introduction-1" id="toc-introduction-1" class="nav-link" data-scroll-target="#introduction-1"><span class="header-section-number">8.2.1</span> Introduction</a></li>
  <li><a href="#what-is-grammar-of-graphics" id="toc-what-is-grammar-of-graphics" class="nav-link" data-scroll-target="#what-is-grammar-of-graphics"><span class="header-section-number">8.2.2</span> What is Grammar of Graphics?</a></li>
  <li><a href="#what-can-you-do-with-plotnine" id="toc-what-can-you-do-with-plotnine" class="nav-link" data-scroll-target="#what-can-you-do-with-plotnine"><span class="header-section-number">8.2.3</span> What can you do with <code>Plotnine</code>?</a></li>
  <li><a href="#using-plotnine" id="toc-using-plotnine" class="nav-link" data-scroll-target="#using-plotnine"><span class="header-section-number">8.2.4</span> Using <code>Plotnine</code></a></li>
  <li><a href="#resources" id="toc-resources" class="nav-link" data-scroll-target="#resources"><span class="header-section-number">8.2.5</span> Resources</a></li>
  <li><a href="#references-1" id="toc-references-1" class="nav-link" data-scroll-target="#references-1"><span class="header-section-number">8.2.6</span> References</a></li>
  </ul></li>
  <li><a href="#handling-spatial-data-with-geopandas" id="toc-handling-spatial-data-with-geopandas" class="nav-link" data-scroll-target="#handling-spatial-data-with-geopandas"><span class="header-section-number">8.3</span> Handling Spatial Data with <code>GeoPandas</code></a>
  <ul class="collapse">
  <li><a href="#introduction-and-installation" id="toc-introduction-and-installation" class="nav-link" data-scroll-target="#introduction-and-installation"><span class="header-section-number">8.3.1</span> Introduction and Installation</a></li>
  <li><a href="#base-concepts" id="toc-base-concepts" class="nav-link" data-scroll-target="#base-concepts"><span class="header-section-number">8.3.2</span> Base Concepts</a></li>
  <li><a href="#reading-files-into-geodataframes" id="toc-reading-files-into-geodataframes" class="nav-link" data-scroll-target="#reading-files-into-geodataframes"><span class="header-section-number">8.3.3</span> Reading Files into <code>GeoDataFrame</code>’s</a></li>
  <li><a href="#plotting" id="toc-plotting" class="nav-link" data-scroll-target="#plotting"><span class="header-section-number">8.3.4</span> Plotting</a></li>
  <li><a href="#interactive-maps" id="toc-interactive-maps" class="nav-link" data-scroll-target="#interactive-maps"><span class="header-section-number">8.3.5</span> Interactive Maps</a></li>
  <li><a href="#setting-and-changing-projections" id="toc-setting-and-changing-projections" class="nav-link" data-scroll-target="#setting-and-changing-projections"><span class="header-section-number">8.3.6</span> Setting and Changing Projections</a></li>
  <li><a href="#references-2" id="toc-references-2" class="nav-link" data-scroll-target="#references-2"><span class="header-section-number">8.3.7</span> References</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Visualization</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="data-visualization-with-matplotlib" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="data-visualization-with-matplotlib"><span class="header-section-number">8.1</span> Data Visualization with <code>matplotlib</code></h2>
<p>This section was written by Weijia Wu.</p>
<div id="4bed3a74" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="536721b0" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">'https://raw.githubusercontent.com/JoannaWuWeijia/Data_Store_WWJ/main/cleaning_data_rodent3.csv'</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="introduction" class="level3" data-number="8.1.1">
<h3 data-number="8.1.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">8.1.1</span> Introduction</h3>
<p>Hi Class, my name is Weijia Wu and I’m a senior double majored in Applied Math and Statistics. The following shows a basic concepts of visulization of python.</p>
</section>
<section id="matplotlib" class="level3" data-number="8.1.2">
<h3 data-number="8.1.2" class="anchored" data-anchor-id="matplotlib"><span class="header-section-number">8.1.2</span> Matplotlib</h3>
<p>Matplotlib is a desktop plotting package designed for plotting and arranging data visually in Python, usually in two-dimensional. It was created by Dr.&nbsp;John Hunter in 2003 as an alternative to Matlab to facilitate scientific computation and data visualization in Python.</p>
<p>Matplotlib is widely used because of its simplicity and effectiveness.</p>
<section id="installation-of-matplotlib" class="level4" data-number="8.1.2.1">
<h4 data-number="8.1.2.1" class="anchored" data-anchor-id="installation-of-matplotlib"><span class="header-section-number">8.1.2.1</span> Installation of <code>Matplotlib</code></h4>
<p>The library can be installed by typing <code>pip install matplotlib</code> in your terminal</p>
<pre><code>pip install matplotlib</code></pre>
</section>
<section id="line-plot" class="level4" data-number="8.1.2.2">
<h4 data-number="8.1.2.2" class="anchored" data-anchor-id="line-plot"><span class="header-section-number">8.1.2.2</span> Line Plot</h4>
<section id="single-plot-with-pyplot-submodule" class="level5" data-number="8.1.2.2.1">
<h5 data-number="8.1.2.2.1" class="anchored" data-anchor-id="single-plot-with-pyplot-submodule"><span class="header-section-number">8.1.2.2.1</span> Single plot with <code>pyplot</code> submodule</h5>
<p>Let’s Start with an sample Line Plot example:</p>
<div id="8bcaae6d" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">10</span>) </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> [i<span class="op">**</span><span class="dv">2</span> <span class="cf">for</span> i <span class="kw">in</span> t]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">4</span>, <span class="dv">4</span>)) </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">## Width and height in inches</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>plt.plot(t, r)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Line Plot Example'</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-4-output-1.png" width="343" height="357" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="x-label-y-label-and-grid" class="level5" data-number="8.1.2.2.2">
<h5 data-number="8.1.2.2.2" class="anchored" data-anchor-id="x-label-y-label-and-grid"><span class="header-section-number">8.1.2.2.2</span> x-label, y-label, and grid:</h5>
<div id="01317853" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">4</span>, <span class="dv">4</span>)) </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>plt.plot(t, r)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Line Plot Example2'</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'t value'</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'r value'</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-5-output-1.png" width="361" height="376" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="add-legend" class="level5" data-number="8.1.2.2.3">
<h5 data-number="8.1.2.2.3" class="anchored" data-anchor-id="add-legend"><span class="header-section-number">8.1.2.2.3</span> Add legend:</h5>
<div id="9d26b5bd" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">4</span>, <span class="dv">4</span>)) </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>plt.plot(t, r)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Line Plot Example3'</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'t value'</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'r value'</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-6-output-2.png" width="361" height="376" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>To add a legend to a plot in Matplotlib, you can use the <code>legend()</code> function.</p>
<p>A legend is a small area on the plot that describes each element of the graph.</p>
<p>To effectively use the legend, you typically need to label the elements of the plot that you want to appear in the legend using the label parameter when plotting them.</p>
<div id="2ce983a2" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">'lower right'</span>, title<span class="op">=</span><span class="st">'Legend Title'</span>, fontsize<span class="op">=</span><span class="st">'small'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-7-output-2.png" width="581" height="416" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The <code>help(plt.legend)</code> command in Python is used to display the documentation for the legend function from the Matplotlib library. This documentation includes a description of what the function does, the parameters it accepts, and other relevant information such as return values and examples of how to use the function.</p>
<div id="81966e95" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="bu">help</span>(plt.legend)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Help on function legend in module matplotlib.pyplot:

legend(*args, **kwargs) -&gt; 'Legend'
    Place a legend on the Axes.

    Call signatures::

        legend()
        legend(handles, labels)
        legend(handles=handles)
        legend(labels)

    The call signatures correspond to the following different ways to use
    this method:

    **1. Automatic detection of elements to be shown in the legend**

    The elements to be added to the legend are automatically determined,
    when you do not pass in any extra arguments.

    In this case, the labels are taken from the artist. You can specify
    them either at artist creation or by calling the
    :meth:`~.Artist.set_label` method on the artist::

        ax.plot([1, 2, 3], label='Inline label')
        ax.legend()

    or::

        line, = ax.plot([1, 2, 3])
        line.set_label('Label via method')
        ax.legend()

    .. note::
        Specific artists can be excluded from the automatic legend element
        selection by using a label starting with an underscore, "_".
        A string starting with an underscore is the default label for all
        artists, so calling `.Axes.legend` without any arguments and
        without setting the labels manually will result in no legend being
        drawn.


    **2. Explicitly listing the artists and labels in the legend**

    For full control of which artists have a legend entry, it is possible
    to pass an iterable of legend artists followed by an iterable of
    legend labels respectively::

        ax.legend([line1, line2, line3], ['label1', 'label2', 'label3'])


    **3. Explicitly listing the artists in the legend**

    This is similar to 2, but the labels are taken from the artists'
    label properties. Example::

        line1, = ax.plot([1, 2, 3], label='label1')
        line2, = ax.plot([1, 2, 3], label='label2')
        ax.legend(handles=[line1, line2])


    **4. Labeling existing plot elements**

    .. admonition:: Discouraged

        This call signature is discouraged, because the relation between
        plot elements and labels is only implicit by their order and can
        easily be mixed up.

    To make a legend for all artists on an Axes, call this function with
    an iterable of strings, one for each legend item. For example::

        ax.plot([1, 2, 3])
        ax.plot([5, 6, 7])
        ax.legend(['First line', 'Second line'])


    Parameters
    ----------
    handles : list of (`.Artist` or tuple of `.Artist`), optional
        A list of Artists (lines, patches) to be added to the legend.
        Use this together with *labels*, if you need full control on what
        is shown in the legend and the automatic mechanism described above
        is not sufficient.

        The length of handles and labels should be the same in this
        case. If they are not, they are truncated to the smaller length.

        If an entry contains a tuple, then the legend handler for all Artists in the
        tuple will be placed alongside a single label.

    labels : list of str, optional
        A list of labels to show next to the artists.
        Use this together with *handles*, if you need full control on what
        is shown in the legend and the automatic mechanism described above
        is not sufficient.

    Returns
    -------
    `~matplotlib.legend.Legend`

    Other Parameters
    ----------------

    loc : str or pair of floats, default: :rc:`legend.loc`
        The location of the legend.

        The strings ``'upper left'``, ``'upper right'``, ``'lower left'``,
        ``'lower right'`` place the legend at the corresponding corner of the
        axes.

        The strings ``'upper center'``, ``'lower center'``, ``'center left'``,
        ``'center right'`` place the legend at the center of the corresponding edge
        of the axes.

        The string ``'center'`` places the legend at the center of the axes.

        The string ``'best'`` places the legend at the location, among the nine
        locations defined so far, with the minimum overlap with other drawn
        artists.  This option can be quite slow for plots with large amounts of
        data; your plotting speed may benefit from providing a specific location.

        The location can also be a 2-tuple giving the coordinates of the lower-left
        corner of the legend in axes coordinates (in which case *bbox_to_anchor*
        will be ignored).

        For back-compatibility, ``'center right'`` (but no other location) can also
        be spelled ``'right'``, and each "string" location can also be given as a
        numeric value:

        ==================   =============
        Location String      Location Code
        ==================   =============
        'best' (Axes only)   0
        'upper right'        1
        'upper left'         2
        'lower left'         3
        'lower right'        4
        'right'              5
        'center left'        6
        'center right'       7
        'lower center'       8
        'upper center'       9
        'center'             10
        ==================   =============

    bbox_to_anchor : `.BboxBase`, 2-tuple, or 4-tuple of floats
        Box that is used to position the legend in conjunction with *loc*.
        Defaults to `axes.bbox` (if called as a method to `.Axes.legend`) or
        `figure.bbox` (if `.Figure.legend`).  This argument allows arbitrary
        placement of the legend.

        Bbox coordinates are interpreted in the coordinate system given by
        *bbox_transform*, with the default transform
        Axes or Figure coordinates, depending on which ``legend`` is called.

        If a 4-tuple or `.BboxBase` is given, then it specifies the bbox
        ``(x, y, width, height)`` that the legend is placed in.
        To put the legend in the best location in the bottom right
        quadrant of the axes (or figure)::

            loc='best', bbox_to_anchor=(0.5, 0., 0.5, 0.5)

        A 2-tuple ``(x, y)`` places the corner of the legend specified by *loc* at
        x, y.  For example, to put the legend's upper right-hand corner in the
        center of the axes (or figure) the following keywords can be used::

            loc='upper right', bbox_to_anchor=(0.5, 0.5)

    ncols : int, default: 1
        The number of columns that the legend has.

        For backward compatibility, the spelling *ncol* is also supported
        but it is discouraged. If both are given, *ncols* takes precedence.

    prop : None or `~matplotlib.font_manager.FontProperties` or dict
        The font properties of the legend. If None (default), the current
        :data:`matplotlib.rcParams` will be used.

    fontsize : int or {'xx-small', 'x-small', 'small', 'medium', 'large', 'x-large', 'xx-large'}
        The font size of the legend. If the value is numeric the size will be the
        absolute font size in points. String values are relative to the current
        default font size. This argument is only used if *prop* is not specified.

    labelcolor : str or list, default: :rc:`legend.labelcolor`
        The color of the text in the legend. Either a valid color string
        (for example, 'red'), or a list of color strings. The labelcolor can
        also be made to match the color of the line or marker using 'linecolor',
        'markerfacecolor' (or 'mfc'), or 'markeredgecolor' (or 'mec').

        Labelcolor can be set globally using :rc:`legend.labelcolor`. If None,
        use :rc:`text.color`.

    numpoints : int, default: :rc:`legend.numpoints`
        The number of marker points in the legend when creating a legend
        entry for a `.Line2D` (line).

    scatterpoints : int, default: :rc:`legend.scatterpoints`
        The number of marker points in the legend when creating
        a legend entry for a `.PathCollection` (scatter plot).

    scatteryoffsets : iterable of floats, default: ``[0.375, 0.5, 0.3125]``
        The vertical offset (relative to the font size) for the markers
        created for a scatter plot legend entry. 0.0 is at the base the
        legend text, and 1.0 is at the top. To draw all markers at the
        same height, set to ``[0.5]``.

    markerscale : float, default: :rc:`legend.markerscale`
        The relative size of legend markers compared to the originally drawn ones.

    markerfirst : bool, default: True
        If *True*, legend marker is placed to the left of the legend label.
        If *False*, legend marker is placed to the right of the legend label.

    reverse : bool, default: False
        If *True*, the legend labels are displayed in reverse order from the input.
        If *False*, the legend labels are displayed in the same order as the input.

        .. versionadded:: 3.7

    frameon : bool, default: :rc:`legend.frameon`
        Whether the legend should be drawn on a patch (frame).

    fancybox : bool, default: :rc:`legend.fancybox`
        Whether round edges should be enabled around the `.FancyBboxPatch` which
        makes up the legend's background.

    shadow : None, bool or dict, default: :rc:`legend.shadow`
        Whether to draw a shadow behind the legend.
        The shadow can be configured using `.Patch` keywords.
        Customization via :rc:`legend.shadow` is currently not supported.

    framealpha : float, default: :rc:`legend.framealpha`
        The alpha transparency of the legend's background.
        If *shadow* is activated and *framealpha* is ``None``, the default value is
        ignored.

    facecolor : "inherit" or color, default: :rc:`legend.facecolor`
        The legend's background color.
        If ``"inherit"``, use :rc:`axes.facecolor`.

    edgecolor : "inherit" or color, default: :rc:`legend.edgecolor`
        The legend's background patch edge color.
        If ``"inherit"``, use take :rc:`axes.edgecolor`.

    mode : {"expand", None}
        If *mode* is set to ``"expand"`` the legend will be horizontally
        expanded to fill the axes area (or *bbox_to_anchor* if defines
        the legend's size).

    bbox_transform : None or `~matplotlib.transforms.Transform`
        The transform for the bounding box (*bbox_to_anchor*). For a value
        of ``None`` (default) the Axes'
        :data:`~matplotlib.axes.Axes.transAxes` transform will be used.

    title : str or None
        The legend's title. Default is no title (``None``).

    title_fontproperties : None or `~matplotlib.font_manager.FontProperties` or dict
        The font properties of the legend's title. If None (default), the
        *title_fontsize* argument will be used if present; if *title_fontsize* is
        also None, the current :rc:`legend.title_fontsize` will be used.

    title_fontsize : int or {'xx-small', 'x-small', 'small', 'medium', 'large', 'x-large', 'xx-large'}, default: :rc:`legend.title_fontsize`
        The font size of the legend's title.
        Note: This cannot be combined with *title_fontproperties*. If you want
        to set the fontsize alongside other font properties, use the *size*
        parameter in *title_fontproperties*.

    alignment : {'center', 'left', 'right'}, default: 'center'
        The alignment of the legend title and the box of entries. The entries
        are aligned as a single block, so that markers always lined up.

    borderpad : float, default: :rc:`legend.borderpad`
        The fractional whitespace inside the legend border, in font-size units.

    labelspacing : float, default: :rc:`legend.labelspacing`
        The vertical space between the legend entries, in font-size units.

    handlelength : float, default: :rc:`legend.handlelength`
        The length of the legend handles, in font-size units.

    handleheight : float, default: :rc:`legend.handleheight`
        The height of the legend handles, in font-size units.

    handletextpad : float, default: :rc:`legend.handletextpad`
        The pad between the legend handle and text, in font-size units.

    borderaxespad : float, default: :rc:`legend.borderaxespad`
        The pad between the axes and legend border, in font-size units.

    columnspacing : float, default: :rc:`legend.columnspacing`
        The spacing between columns, in font-size units.

    handler_map : dict or None
        The custom dictionary mapping instances or types to a legend
        handler. This *handler_map* updates the default handler map
        found at `matplotlib.legend.Legend.get_legend_handler_map`.

    draggable : bool, default: False
        Whether the legend can be dragged with the mouse.


    See Also
    --------
    .Figure.legend

    Notes
    -----
    Some artists are not supported by this function.  See
    :ref:`legend_guide` for details.

    Examples
    --------
    .. plot:: gallery/text_labels_and_annotations/legend.py
</code></pre>
</div>
</div>
</section>
<section id="colors-markers-and-line-styles" class="level5" data-number="8.1.2.2.4">
<h5 data-number="8.1.2.2.4" class="anchored" data-anchor-id="colors-markers-and-line-styles"><span class="header-section-number">8.1.2.2.4</span> Colors, Markers, and Line Styles</h5>
<p>If we want two plots in the same, we need to find a way to make the distinction between them.</p>
<div id="df331af7" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>r2 <span class="op">=</span> [i<span class="op">**</span><span class="dv">3</span> <span class="cf">for</span> i <span class="kw">in</span> t]</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">4</span>, <span class="dv">4</span>)) </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>plt.plot(t, r, linestyle <span class="op">=</span> <span class="st">'--'</span>, color <span class="op">=</span> <span class="st">'r'</span>, marker <span class="op">=</span> <span class="st">'o'</span>, label <span class="op">=</span> <span class="st">'r'</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>plt.plot(t, r2, linestyle <span class="op">=</span> <span class="st">'-'</span>, color <span class="op">=</span> <span class="st">'b'</span>, marker <span class="op">=</span> <span class="st">'v'</span>, label <span class="op">=</span> <span class="st">'r2'</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Line Plot Example2'</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'t value'</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'r value'</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-9-output-1.png" width="370" height="376" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Use <code>linestyle</code>, <code>color</code>, and <code>Markers</code> to set linestyles:</p>
<div id="061d8e7f" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">## help(plt.plot)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="example-with-rodent-data" class="level3" data-number="8.1.3">
<h3 data-number="8.1.3" class="anchored" data-anchor-id="example-with-rodent-data"><span class="header-section-number">8.1.3</span> Example with rodent data:</h3>
<p>Let’s use our rodent data to demonstrate the Monthly Reported data:</p>
<div id="bbb933a0" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Created Date'</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">'Created Date'</span>])</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Month'</span>] <span class="op">=</span> df[<span class="st">'Created Date'</span>].dt.to_period(<span class="st">'M'</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>monthly_counts <span class="op">=</span> df.groupby(<span class="st">'Month'</span>).size()</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">8</span>))</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>monthly_counts.plot(kind<span class="op">=</span><span class="st">'line'</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Monthly Report Count'</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Month'</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Number of Reports'</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/cq/5ysgnwfn7c3g0h46xyzvpj800000gn/T/ipykernel_20038/3959770936.py:1: UserWarning:

Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-11-output-2.png" width="825" height="702" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>This plot shows the number of rodents in each month’s report, and we can draw the following conclusions: rodent sights occur mostly in the spring and summer, and they fall dramatically after the start of autumn (post-August).</p>
<section id="scatter-plot" class="level4" data-number="8.1.3.1">
<h4 data-number="8.1.3.1" class="anchored" data-anchor-id="scatter-plot"><span class="header-section-number">8.1.3.1</span> Scatter plot</h4>
<div id="852d1942" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">8465</span>)<span class="op">;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.random.uniform(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">10</span>)<span class="op">;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.random.uniform(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">10</span>)<span class="op">;</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> np.random.uniform(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">10</span>)<span class="op">;</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>plt.scatter(x, y)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'X'</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Y'</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-12-output-1.png" width="589" height="429" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="bar-plot" class="level4" data-number="8.1.3.2">
<h4 data-number="8.1.3.2" class="anchored" data-anchor-id="bar-plot"><span class="header-section-number">8.1.3.2</span> Bar Plot</h4>
<div id="3f1e2ffa" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>borough_counts <span class="op">=</span> df[<span class="st">'Borough'</span>].value_counts()</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))  </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>plt.bar(borough_counts.index, borough_counts.values, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Borough'</span>)  </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Number of Rodent Sightings'</span>)  </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Rodent Sightings by Borough'</span>) </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)  <span class="co"># Rotate the X axis by 45 degrees to show the long labels</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-13-output-1.png" width="684" height="593" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="multiple-plots-using-subplots-submodule" class="level4" data-number="8.1.3.3">
<h4 data-number="8.1.3.3" class="anchored" data-anchor-id="multiple-plots-using-subplots-submodule"><span class="header-section-number">8.1.3.3</span> Multiple plots using <code>subplots</code> submodule</h4>
<div id="451d815a" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Created Date'</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">'Created Date'</span>])</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Date'</span>] <span class="op">=</span> df[<span class="st">'Created Date'</span>].dt.date</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>daily_reports <span class="op">=</span> df.groupby([<span class="st">'Date'</span>, <span class="st">'Incident Zip'</span>]).size().reset_index(name<span class="op">=</span><span class="st">'Counts'</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>sample_zip <span class="op">=</span> daily_reports[<span class="st">'Incident Zip'</span>].dropna().iloc[<span class="dv">0</span>]</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>sample_data <span class="op">=</span> daily_reports[daily_reports[<span class="st">'Incident Zip'</span>] <span class="op">==</span> sample_zip]</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">## 2x2 Plot</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">8</span>))</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co">## Line Plot</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>, <span class="dv">0</span>].plot(sample_data[<span class="st">'Date'</span>], sample_data[<span class="st">'Counts'</span>], <span class="st">'-o'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>, <span class="dv">0</span>].set_title(<span class="ss">f'Linear Plot of Reports for Zip </span><span class="sc">{</span>sample_zip<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>, <span class="dv">0</span>].tick_params(labelrotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co">## Box Plot</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>, <span class="dv">1</span>].boxplot(df[<span class="st">'Y Coordinate (State Plane)'</span>].dropna())</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>, <span class="dv">1</span>].set_title(<span class="st">'Boxplot of Y Coordinate'</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="co">## barplot</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>status_counts <span class="op">=</span> df[<span class="st">'Status'</span>].value_counts()</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>, <span class="dv">0</span>].bar(status_counts.index, status_counts.values, color<span class="op">=</span><span class="st">'skyblue'</span>)</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>, <span class="dv">0</span>].set_title(<span class="st">'Barplot of Status Counts'</span>)</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>, <span class="dv">0</span>].tick_params(labelrotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="co">## histogram</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>, <span class="dv">1</span>].hist(df[<span class="st">'Latitude'</span>].dropna(), bins<span class="op">=</span><span class="dv">30</span>, color<span class="op">=</span><span class="st">'orange'</span>)</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>, <span class="dv">1</span>].set_title(<span class="st">'Histogram of Latitude'</span>)</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-14-output-1.png" width="758" height="758" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="save-the-files" class="level4" data-number="8.1.3.4">
<h4 data-number="8.1.3.4" class="anchored" data-anchor-id="save-the-files"><span class="header-section-number">8.1.3.4</span> Save the files</h4>
<p><code>help(plt.savefig)</code>allows you to save the current figure created by Matplotlib to a file. You can specify the filename and various options to control the format, quality, and layout of the output file.</p>
<div id="305daef6" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">## help(plt.savefig)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="pandas" class="level3" data-number="8.1.4">
<h3 data-number="8.1.4" class="anchored" data-anchor-id="pandas"><span class="header-section-number">8.1.4</span> Pandas</h3>
<p>Pandas plotting is built on top of Matplotlib, and one of its main benefits is that it allows you to generate plots with fewer lines of code directly from Pandas data structures like DataFrames and Series. This integration simplifies the process of visualizing data for analysis.</p>
<section id="line-plot-1" class="level4" data-number="8.1.4.1">
<h4 data-number="8.1.4.1" class="anchored" data-anchor-id="line-plot-1"><span class="header-section-number">8.1.4.1</span> Line Plot</h4>
<section id="single-plot" class="level5" data-number="8.1.4.1.1">
<h5 data-number="8.1.4.1.1" class="anchored" data-anchor-id="single-plot"><span class="header-section-number">8.1.4.1.1</span> Single plot</h5>
<div id="083a5585" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>monthly_counts.plot(kind<span class="op">=</span><span class="st">'line'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-16-output-1.png" width="583" height="444" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Because the line plot is default in pandas plots, you can omit the (kind=‘line’)</p>
<p>When plotting with the .plot() method in Pandas, it is true that you can generate basic plots with fewer lines of code, due to the fact that Pandas automatically handles some of the basic settings, such as setting the x-axis labels automatically. However, for more detailed chart customization, such as setting gridlines, rotating x-axis labels, and so on, you may need additional Matplotlib commands to implement them.</p>
<div id="de8278b3" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>monthly_counts.plot(kind<span class="op">=</span><span class="st">'line'</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Monthly Report Count'</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Month'</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Number of Reports'</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co">## For longer tags, avoid overlapping</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-17-output-1.png" width="676" height="554" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="multi-lineplot" class="level5" data-number="8.1.4.1.2">
<h5 data-number="8.1.4.1.2" class="anchored" data-anchor-id="multi-lineplot"><span class="header-section-number">8.1.4.1.2</span> Multi-Lineplot</h5>
<p>The following is showing several line plots in the same figure.</p>
<div id="f52f653d" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>community_counts <span class="op">=</span> df[<span class="st">'Community Districts'</span>].value_counts().sort_index()</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>city_council_counts <span class="op">=</span> df[<span class="st">'City Council Districts'</span>].value_counts().sort_index()</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>police_precincts_counts <span class="op">=</span> df[<span class="st">'Police Precincts'</span>].value_counts().sort_index()</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>counts_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Community Districts'</span>: community_counts,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'City Council Districts'</span>: city_council_counts,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Police Precincts'</span>: police_precincts_counts</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>counts_df <span class="op">=</span> counts_df.fillna(<span class="dv">0</span>) </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co">##Fill missing values to 0</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>counts_df[[<span class="st">'Community Districts'</span>, <span class="st">'City Council Districts'</span>, </span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="st">'Police Precincts'</span>]].plot() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-18-output-1.png" width="587" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>When you use the .plot() method on a Pandas DataFrame to create a multi-line plot, each line in the plot is automatically assigned a different color to help distinguish between the different data columns visually. The colors are chosen from a default color cycle provided by Matplotlib.</p>
<p>If you want to customize the color:</p>
<div id="5d9c899c" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>counts_df[[<span class="st">'Community Districts'</span>, <span class="st">'City Council Districts'</span>, <span class="st">'Police Precincts'</span>]].plot(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[<span class="st">'red'</span>, <span class="st">'green'</span>, <span class="st">'blue'</span>]  <span class="co"># Custom colors for each line</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-19-output-1.png" width="587" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="additional-arguments" class="level4" data-number="8.1.4.2">
<h4 data-number="8.1.4.2" class="anchored" data-anchor-id="additional-arguments"><span class="header-section-number">8.1.4.2</span> Additional arguments</h4>
<p>For more info pleased check:</p>
<div id="5c97a132" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>[additional arguments](https:<span class="op">//</span>drive.google.com<span class="op">/</span><span class="bu">file</span><span class="op">/</span>d<span class="op">/</span><span class="ot">1j</span><span class="er">5T7_VMT1Nt4myukcmar0UMcZOHqurCk</span><span class="op">/</span>view?usp<span class="op">=</span>sharing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>zsh:1: bad pattern: [additional</code></pre>
</div>
</div>
<div id="f25f3cd2" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">## help(plt.plot)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="bar-plot-1" class="level4" data-number="8.1.4.3">
<h4 data-number="8.1.4.3" class="anchored" data-anchor-id="bar-plot-1"><span class="header-section-number">8.1.4.3</span> Bar Plot</h4>
<p>For categorical data, one of common visualization is the barplot.</p>
<ul>
<li>Generated using <code>df.plot.bar()</code> method, for horizontal version <code>df.plot.barh()</code>.</li>
</ul>
<section id="side-by-side-bar-plot" class="level5" data-number="8.1.4.3.1">
<h5 data-number="8.1.4.3.1" class="anchored" data-anchor-id="side-by-side-bar-plot"><span class="header-section-number">8.1.4.3.1</span> Side-by-side Bar Plot:</h5>
<p>Let’s use Borough and Location Type to generate a side-by-side bar plot, one horizontal and one vertical:</p>
<div id="06aa7e5b" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Vertical bar plot for Borough counts</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>df.groupby([<span class="st">'Borough'</span>]).size().plot.bar(ax<span class="op">=</span>axs[<span class="dv">0</span>], color<span class="op">=</span><span class="st">'skyblue'</span>, rot<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_title(<span class="st">'Bar plot for Borough'</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co">## Horizontal bar plot for Location Type counts</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>df.groupby([<span class="st">'Location Type'</span>]).size().plot.barh(ax<span class="op">=</span>axs[<span class="dv">1</span>], color<span class="op">=</span><span class="st">'lightgreen'</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_title(<span class="st">'Bar plot for Location Type'</span>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-22-output-1.png" width="758" height="566" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Similiar with <code>axs</code> in matplotlib:</p>
<ul>
<li><code>nrows=1</code> means there will be 1 row of subplots.</li>
<li><code>ncols=2</code>means there will be 2 columns of subplots.</li>
</ul>
</section>
<section id="grouped-bar-plot" class="level5" data-number="8.1.4.3.2">
<h5 data-number="8.1.4.3.2" class="anchored" data-anchor-id="grouped-bar-plot"><span class="header-section-number">8.1.4.3.2</span> Grouped Bar Plot</h5>
<p>This type of plot is useful for comparing the distribution within each class side by side.</p>
<div id="9f0cd3bf" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>class_Borough <span class="op">=</span> pd.crosstab(df[<span class="st">"Borough"</span>], df[<span class="st">"Status"</span>])</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>class_Borough.plot.bar(rot<span class="op">=</span><span class="dv">45</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-23-output-1.png" width="666" height="573" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="stacked-bar-plot" class="level5" data-number="8.1.4.3.3">
<h5 data-number="8.1.4.3.3" class="anchored" data-anchor-id="stacked-bar-plot"><span class="header-section-number">8.1.4.3.3</span> Stacked Bar Plot</h5>
<p>This plot is useful for comparing the total counts across borough while still being able to see the proportion of each borough within each class.</p>
<div id="b5c4bef0" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>class_Borough.plot.bar(stacked<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-24-output-1.png" width="592" height="520" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="histogram-and-density-plots" class="level4" data-number="8.1.4.4">
<h4 data-number="8.1.4.4" class="anchored" data-anchor-id="histogram-and-density-plots"><span class="header-section-number">8.1.4.4</span> Histogram and Density Plots</h4>
<p>For numeric data, histogram allows us to see the distribution (center shape, skewness) of the data.</p>
<p>Histogram can be generated using <code>df.plot.hist()</code> method</p>
<p>Since we have limited numeric data in our rodent data, I used student achievement data to present it:</p>
<div id="d341f6d8" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>url2 <span class="op">=</span> <span class="st">'https://raw.githubusercontent.com/JoannaWuWeijia/Data_Store_WWJ/main/grades_example.csv'</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> pd.read_csv(url2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="3ae97160" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>df2[<span class="st">"Grade"</span>].plot.hist(bins <span class="op">=</span> <span class="dv">10</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-26-output-1.png" width="667" height="485" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>As can be seen from the plot, the students’ scores show a normal distribution, with most of them clustered in the 70-80 range</p>
<div id="deb9fe82" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>df2[<span class="st">"Grade"</span>].plot.density()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-27-output-1.png" width="606" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="scatter-plots" class="level4" data-number="8.1.4.5">
<h4 data-number="8.1.4.5" class="anchored" data-anchor-id="scatter-plots"><span class="header-section-number">8.1.4.5</span> Scatter Plots</h4>
<p>When dealing with two variables, scatter plot allow us to examine if there is any correlation between them.</p>
<p>Scatter can be generated using <code>df.plot.scatter(x = col1, y = col2)</code> method.</p>
<div id="d136c821" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>url3 <span class="op">=</span> <span class="st">'https://raw.githubusercontent.com/JoannaWuWeijia/Data_Store_WWJ/main/student_example3.csv'</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>df3 <span class="op">=</span> pd.read_csv(url3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="3c090f0b" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>df3.plot.scatter(x<span class="op">=</span><span class="st">"Weight"</span>, y<span class="op">=</span><span class="st">"Height"</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-29-output-1.png" width="667" height="505" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>As you can see it’s roughly a linear regression, and I’ll cover how to add a regression line in the next sns section.</p>
</section>
</section>
<section id="seaborn" class="level3" data-number="8.1.5">
<h3 data-number="8.1.5" class="anchored" data-anchor-id="seaborn"><span class="header-section-number">8.1.5</span> Seaborn</h3>
<ul>
<li><p>Seaborn is designed to work directly with pandas DataFrames, making plotting more convenient by allowing direct use of DataFrame columns for specifying data in plots.</p></li>
<li><p>Seaborn makes it easy to add linear regression lines and other statistical models to your charts, simplifying the process of statistical data visualization.</p></li>
<li><p>Seaborn’s default styles and color are more aesthetically pleasing and modern compared to Matplotlib.</p></li>
</ul>
<section id="installation-of-seaborn" class="level4" data-number="8.1.5.1">
<h4 data-number="8.1.5.1" class="anchored" data-anchor-id="installation-of-seaborn"><span class="header-section-number">8.1.5.1</span> Installation of <code>Seaborn</code></h4>
<pre><code>pip install seaborn</code></pre>
</section>
<section id="histogram-and-density-plots-1" class="level4" data-number="8.1.5.2">
<h4 data-number="8.1.5.2" class="anchored" data-anchor-id="histogram-and-density-plots-1"><span class="header-section-number">8.1.5.2</span> Histogram and Density Plots</h4>
<div id="cc2d2487" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">## help(sns.histplot) </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="6b5a44cc" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>sns.histplot(df2[<span class="st">'Grade'</span>], bins<span class="op">=</span><span class="dv">10</span>, kde <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-31-output-1.png" width="667" height="503" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>bins</code>: The number of bars in the histogram. More bins can make the data distribution more detailed, but too many may cause the chart to be difficult to understand; fewer bins may not be able to show the data distribution accurately. <code>kde</code>: (Kernel Density Estimate Line) a density curve will be added to the histogram, which is generated by kernel density estimation and can help understand the shape of the data distribution</p>
</section>
<section id="scatter-plot-with-regression-line" class="level4" data-number="8.1.5.3">
<h4 data-number="8.1.5.3" class="anchored" data-anchor-id="scatter-plot-with-regression-line"><span class="header-section-number">8.1.5.3</span> Scatter plot with Regression line</h4>
<p>I used an example with less data to be able to show it. We can see that the height and weight of the students are directly proportional.</p>
<div id="4d1add8a" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>df4 <span class="op">=</span> pd.DataFrame({</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Student'</span>: [<span class="st">'Alice'</span>, <span class="st">'Bob'</span>, <span class="st">'Charlie'</span>, <span class="st">'David'</span>, </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Eva'</span>, <span class="st">'Fiona'</span>, <span class="st">'George'</span>, <span class="st">'Hannah'</span>, <span class="st">'Ian'</span>, <span class="st">'Julia'</span>],</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Height'</span>: [<span class="dv">160</span>, <span class="dv">172</span>, <span class="dv">158</span>, <span class="dv">165</span>, <span class="dv">170</span>, <span class="dv">162</span>, <span class="dv">175</span>, <span class="dv">168</span>, <span class="dv">180</span>, <span class="dv">155</span>],</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Weight'</span>: [<span class="dv">55</span>, <span class="dv">72</span>, <span class="dv">60</span>, <span class="dv">68</span>, <span class="dv">62</span>, <span class="dv">56</span>, <span class="dv">80</span>, <span class="dv">65</span>, <span class="dv">75</span>, <span class="dv">50</span>]})</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>sns.regplot(x<span class="op">=</span><span class="st">'Weight'</span>, y<span class="op">=</span><span class="st">'Height'</span>, data<span class="op">=</span>df4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-32-output-1.png" width="668" height="503" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="categorical-data" class="level4" data-number="8.1.5.4">
<h4 data-number="8.1.5.4" class="anchored" data-anchor-id="categorical-data"><span class="header-section-number">8.1.5.4</span> Categorical Data</h4>
<section id="barplot" class="level5" data-number="8.1.5.4.1">
<h5 data-number="8.1.5.4.1" class="anchored" data-anchor-id="barplot"><span class="header-section-number">8.1.5.4.1</span> barplot</h5>
<div id="c0d20058" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">0</span>) </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>genders <span class="op">=</span> np.random.choice([<span class="st">'Male'</span>, <span class="st">'Female'</span>], size<span class="op">=</span><span class="dv">500</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>classes <span class="op">=</span> np.random.choice([<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'D'</span>], size<span class="op">=</span><span class="dv">500</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>grades <span class="op">=</span> np.random.choice([<span class="st">'Excellent'</span>, <span class="st">'Good'</span>, <span class="st">'Average'</span>, <span class="st">'Poor'</span>], size<span class="op">=</span><span class="dv">500</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>df4 <span class="op">=</span> pd.DataFrame({<span class="st">'Gender'</span>: genders, <span class="st">'Class'</span>: classes, <span class="st">'Grades'</span>: grades})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="973db10e" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>sns.catplot(x<span class="op">=</span><span class="st">'Class'</span>, hue<span class="op">=</span><span class="st">'Gender'</span>, col<span class="op">=</span><span class="st">'Grades'</span>, </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>kind<span class="op">=</span><span class="st">'count'</span>, data<span class="op">=</span>df4, height<span class="op">=</span><span class="dv">5</span>, col_wrap<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-34-output-1.png" width="1049" height="950" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><code>x='Class'</code>: This sets the x-axis to represent different classes, so each class will have its own set of bars in the plot.</p></li>
<li><p><code>hue='Gender'</code>: This parameter adds a color coding (hue) based on the ‘Gender’ column</p></li>
<li><p><code>col='Grades'</code>: This creates separate subplots (columns) for each unique value in the ‘Grades’ column (e.g., Excellent, Good, Average, Poor), effectively grouping the data by grades.</p></li>
<li><p><code>col_wrap=2</code>: Limits the number of these subplots to 2 per row. If there are more than 2 unique grades, additional rows will be created to accommodate all the subplots.</p></li>
<li><p><code>kind='count'</code>: Specifies the kind of plot to draw. In this case, <code>'count'</code>means it will count the occurrences of each category combination and display this as bars in the plot.</p></li>
<li><p><code>height</code>=5: Sets the height of each subplot to 5 inches.</p></li>
</ul>
</section>
<section id="box-plot" class="level5" data-number="8.1.5.4.2">
<h5 data-number="8.1.5.4.2" class="anchored" data-anchor-id="box-plot"><span class="header-section-number">8.1.5.4.2</span> Box Plot</h5>
<div id="840a21e3" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'Gender'</span>, y<span class="op">=</span><span class="st">'Grades'</span>, hue<span class="op">=</span><span class="st">'Class'</span>, data<span class="op">=</span>df4)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-35-output-1.png" width="628" height="429" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><code>x='Gender'</code>: x-axis variable</p></li>
<li><p><code>y='Grades'</code>: y-axis variable, which in this case is ‘Grades’. Since ‘Grades’ is a categorical variable with values like ‘Excellent’, ‘Good’, ‘Average’, ‘Poor’</p></li>
<li><p><code>col='Class'</code>: Creates separate subplots for each unique value in the ‘Class’ column, effectively grouping the data by class.</p></li>
</ul>
</section>
<section id="categorical-data-help" class="level5" data-number="8.1.5.4.3">
<h5 data-number="8.1.5.4.3" class="anchored" data-anchor-id="categorical-data-help"><span class="header-section-number">8.1.5.4.3</span> Categorical Data Help</h5>
<div id="4822b624" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">##help(sns.catplot)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="conclusion" class="level3" data-number="8.1.6">
<h3 data-number="8.1.6" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">8.1.6</span> Conclusion</h3>
<p><code>Matplotlib</code> is the foundation for making plots in Python.</p>
<p><code>pandas</code> uses Matplotlib for its plotting features but is mainly for handling data.</p>
<p><code>Seaborn</code> makes Matplotlib prettier and easier to use, especially with pandas data.</p>
</section>
<section id="references" class="level3" data-number="8.1.7">
<h3 data-number="8.1.7" class="anchored" data-anchor-id="references"><span class="header-section-number">8.1.7</span> References</h3>
<ul>
<li>https://matplotlib.org/stable/users/project/history.html</li>
<li>https://matplotlib.org/stable/gallery/lines_bars_and_markers/simple_plot.html</li>
<li>https://www.simplilearn.com/tutorials/python-tutorial/matplotlib</li>
<li>https://www.w3schools.com/python/pandas/pandas_plotting.asp</li>
<li>https://github.com/mwaskom/seaborn/tree/master/seaborn</li>
<li>https://seaborn.pydata.org/installing.html</li>
<li>https://ritza.co/articles/matplotlib-vs-seaborn-vs-plotly-vs-MATLAB-vs-ggplot2-vs-pandas/</li>
</ul>
</section>
</section>
<section id="grammar-of-graphics-with-plotnine" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="grammar-of-graphics-with-plotnine"><span class="header-section-number">8.2</span> Grammar of Graphics with <code>Plotnine</code></h2>
<p>This section was written by Olivia Massad.</p>
<section id="introduction-1" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="introduction-1"><span class="header-section-number">8.2.1</span> Introduction</h3>
<p>Hello everyone! My name is Olivia Massad and I am a junior Statistical Data Science Major. I am very interested in sports statistics and analytics, especially involving football, and am very excited to learn more about coding and data science in this class. Today I will be talking about grammar of graphics for python, using <code>Plotnine</code>. This is a new topic for me so I am very excited to show you all what we can do with it.</p>
</section>
<section id="what-is-grammar-of-graphics" class="level3" data-number="8.2.2">
<h3 data-number="8.2.2" class="anchored" data-anchor-id="what-is-grammar-of-graphics"><span class="header-section-number">8.2.2</span> What is Grammar of Graphics?</h3>
<p>Similarly to how languages have grammar in order to structure language and create a standard for how sentences and words should be arranged, grammar of graphics provides the framework for a consistent way to structure and create statistical visualizations. This framework helps us to create graphs and visualizations which can be widely understood due to the consistent structure. The major components of grammar of graphics are:</p>
<ul>
<li><p>Data: our datasets and the what components you want to visualize.</p></li>
<li><p>Aesthetics: axes, position of data points, color, shape, size.</p></li>
<li><p>Scale: scale values or use specific scales depending on multiple values and ranges.</p></li>
<li><p>Geometric objects: how data points are depicted, whether they’re points, lines, bars, etc.</p></li>
<li><p>Statistics: statistical measures of the data included in the graphic, including mean, spread, confidence intervals, etc.</p></li>
<li><p>Facets: subplots for specific data dimensions.</p></li>
<li><p>Coordinate system: cartesian or polar.</p></li>
</ul>
</section>
<section id="what-can-you-do-with-plotnine" class="level3" data-number="8.2.3">
<h3 data-number="8.2.3" class="anchored" data-anchor-id="what-can-you-do-with-plotnine"><span class="header-section-number">8.2.3</span> What can you do with <code>Plotnine</code>?</h3>
<p><code>Plotnine</code> is a program which implements grammar of graphics in order to create data visualizations and graphs using python. It is based on <code>ggplot2</code> and allows for many variations within graphs. Some examples of things we can create with <code>plotnine</code> are:</p>
<ul>
<li>Bar Charts</li>
<li>Histograms</li>
<li>Box Plots</li>
<li>Scatter Plots</li>
<li>Line Charts</li>
<li>Time Series</li>
<li>Density Plots</li>
<li>etc.</li>
</ul>
</section>
<section id="using-plotnine" class="level3" data-number="8.2.4">
<h3 data-number="8.2.4" class="anchored" data-anchor-id="using-plotnine"><span class="header-section-number">8.2.4</span> Using <code>Plotnine</code></h3>
<p>In order to use <code>plotnine</code> we first need to install the package using our command line.</p>
<p>With <code>conda</code>: “conda install -c conda-forge plotnine”</p>
<p>With <code>pip</code>: “pip install plotnine pip install plotnine[all]”</p>
<p>Now that <code>plotnine</code> is installed, we must call the it in python.</p>
<div id="3044c70e" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotnine <span class="im">import</span> <span class="op">*</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotnine.data <span class="im">import</span> <span class="op">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that <code>plotnine</code> is installed and imported, we can begin to make graphs and plots. Below are different examples of visualizations we can make using <code>plotnine</code> and the personalizations we can add to them. For these graphics I used the rodent sighting data from the NYC open data 311 requests. We also will need pandas and numpy for some of these graphs so we need to import those as well. Additionally, because the data set is so large, we will only be lookng at the first 500 complaints.</p>
<div id="501221a9" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotnine <span class="im">import</span> <span class="op">*</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotnine.data <span class="im">import</span> <span class="op">*</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>folder <span class="op">=</span> <span class="st">'data'</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="bu">file</span> <span class="op">=</span> <span class="st">'rodent_2022-2023.feather'</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> os.path.join(folder, <span class="bu">file</span>)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_feather(path)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>data_used <span class="op">=</span> data.head(<span class="dv">500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="bar-chart" class="level4" data-number="8.2.4.1">
<h4 data-number="8.2.4.1" class="anchored" data-anchor-id="bar-chart"><span class="header-section-number">8.2.4.1</span> Bar Chart</h4>
<p>One common type of visualization we can create with <code>plotnine</code> is a bar chart. For this graph we will look at the data for the descriptors of each complaint.</p>
<div id="09cb238e" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>(ggplot(data_used, aes(x <span class="op">=</span> <span class="st">'descriptor'</span>)) </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> geom_bar())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-39-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>While this code provides us with a nice simple chart, because we are using <code>plotnine</code>, we can make some major improvements to the visualization to make it easier to read and more appealing. Some simple things we can do are:</p>
<ul>
<li>Add a title.</li>
<li>Color code the bars.</li>
<li>Change the orientation of the graph.</li>
<li>Add titles to the axes.</li>
</ul>
<div id="38293ca3" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>(ggplot(data_used, aes(x <span class="op">=</span> <span class="st">'descriptor'</span>, fill <span class="op">=</span> <span class="st">'descriptor'</span>)) </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Color code the bars.</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> geom_bar() <span class="co"># Bar Chart</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> ggtitle(<span class="st">'Descriptor Counts'</span>) <span class="co"># Add a title.</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> coord_flip() <span class="co"># Change the orientation of the graph.</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> xlab(<span class="st">"Descriptor"</span>) <span class="co"># Add title to x axis.</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> ylab(<span class="st">"Number of Complaints"</span>) <span class="co"># Add titles to y axis.</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-40-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Some more complex changes we can make to our graph are:</p>
<ul>
<li>Change the orientation of the words on the axes to make them easier to read.</li>
<li>Add color coded descriptors to each bar.</li>
</ul>
<div id="0b88e0de" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>(ggplot(data_used, aes(x <span class="op">=</span> <span class="st">'descriptor'</span>, fill <span class="op">=</span> <span class="st">'borough'</span>)) </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add color coded descriptors.</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> geom_bar() <span class="co"># Bar Chart</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> ggtitle(<span class="st">'Descriptor Counts'</span>) <span class="co"># Add a title.</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> xlab(<span class="st">"Descriptor"</span>) <span class="co"># Add title to x axis.</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> ylab(<span class="st">"Number of Complaints"</span>) <span class="co"># Add titles to y axis.</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> theme(axis_text_x<span class="op">=</span>element_text(angle<span class="op">=</span><span class="dv">45</span>))</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>     <span class="co"># Change the orientation of the words.</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-41-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="scatter-plot-1" class="level4" data-number="8.2.4.2">
<h4 data-number="8.2.4.2" class="anchored" data-anchor-id="scatter-plot-1"><span class="header-section-number">8.2.4.2</span> Scatter Plot</h4>
<p>Another common visualization we can create is a scatterplot. When looking at the data from the 311 requests, we can see that there are many data points for locations of these complaints. A scatter plot would be a great way to see the location of the complaints by graphing the longitudes and latitudes. In order to better see the points, for this graph we will only use the first 200 complaints.</p>
<div id="781bfb9a" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>data_scatter <span class="op">=</span> data.tail(<span class="dv">200</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>(ggplot(data_scatter, aes(x <span class="op">=</span> <span class="st">'longitude'</span>, y <span class="op">=</span> <span class="st">'latitude'</span>)) </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> geom_point())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-42-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Similarly to the original code for the bar chart, this code provides a very simple scatter plot. <code>Plotnine</code> allows us to add many specializations to the scatterplot in order to differentiate the points from each other. We can:</p>
<ul>
<li>Add color to the points.</li>
<li>Differentiate using point size.</li>
<li>Differentiate using point shape.</li>
</ul>
<div id="e926a2f5" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>(ggplot(data_scatter, aes(x <span class="op">=</span> <span class="st">'longitude'</span>, y <span class="op">=</span> <span class="st">'latitude'</span>,</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>       color <span class="op">=</span> <span class="st">'location_type'</span>)) <span class="co"># Add color to the points.</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> geom_point())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-43-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="5e8fc42a" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>(ggplot(data_scatter, aes(x <span class="op">=</span> <span class="st">'longitude'</span>, y <span class="op">=</span> <span class="st">'latitude'</span>,</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    size <span class="op">=</span> <span class="st">'descriptor'</span>, <span class="co"># Differentiate using point size.</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    shape <span class="op">=</span> <span class="st">'borough'</span>)) <span class="co"># Differentiate using point shape.</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> geom_point())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/junyan/work/teaching/ids-s24/ids-s24/.myvenv/lib/python3.12/site-packages/plotnine/scales/scale_size.py:51: PlotnineWarning: Using size for a discrete variable is not advised.</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-44-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can see that due to the close data points, filtering the data using size and shape can become a little congested. One thing we can do to fix this while still viewing the same data is through the use of “facet_grid”.</p>
<div id="e392929b" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>(ggplot(data_scatter, aes(x <span class="op">=</span> <span class="st">'longitude'</span>, y <span class="op">=</span> <span class="st">'latitude'</span>,</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>    shape <span class="op">=</span> <span class="st">'borough'</span>)) <span class="co"># Differentiate using point shape.</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> geom_point()</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> facet_grid(<span class="st">'descriptor ~ .'</span>) <span class="co"># Create multiple plots.</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-45-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="d402b5c4" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>(ggplot(data_scatter, aes(x <span class="op">=</span> <span class="st">'longitude'</span>, y <span class="op">=</span> <span class="st">'latitude'</span>))</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> geom_point()</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> facet_grid(<span class="st">'descriptor ~ borough'</span>) </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create multiple plots with 2 conditions.</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> theme(strip_text_y <span class="op">=</span> element_text(angle <span class="op">=</span> <span class="dv">0</span>), <span class="co"># change facet text angle</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>        axis_text_x<span class="op">=</span>element_text(angle<span class="op">=</span><span class="dv">45</span>)) <span class="co"># change x axis text angle</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-46-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="histogram" class="level4" data-number="8.2.4.3">
<h4 data-number="8.2.4.3" class="anchored" data-anchor-id="histogram"><span class="header-section-number">8.2.4.3</span> Histogram</h4>
<p>The last common graph we will cover using <code>plotnine</code> is a histogram. Here we will use the created date data as a continuous variable. Using <code>plotnine</code> we are able to make many of the same personalizations we were able to do with bar charts.</p>
<div id="2f2a5aea" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>data_used[<span class="st">'created_date'</span>]<span class="op">=</span>pd.to_datetime(</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  data_used[<span class="st">'created_date'</span>],</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="bu">format</span> <span class="op">=</span> <span class="st">"%m/</span><span class="sc">%d</span><span class="st">/%Y %I:%M:%S %p"</span>, errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>(ggplot(data_used, aes(x<span class="op">=</span><span class="st">'created_date'</span>))</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> geom_histogram())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/cq/5ysgnwfn7c3g0h46xyzvpj800000gn/T/ipykernel_20038/966048317.py:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
/Users/junyan/work/teaching/ids-s24/ids-s24/.myvenv/lib/python3.12/site-packages/plotnine/stats/stat_bin.py:109: PlotnineWarning: 'stat_bin()' using 'bins = 10'. Pick better value with 'binwidth'.</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-47-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Now that we have a simple histogram with our data we can add specializations, inclduing:</p>
<ul>
<li>Change width of bins.</li>
<li>Change oreintation of graph.</li>
<li>Add color coded descriptors.</li>
<li>Change outline color.</li>
<li>Change the orientation of the words on the axes to make them easier to read.</li>
</ul>
<div id="ac52c2d4" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>(ggplot(data_used, aes(x<span class="op">=</span><span class="st">'created_date'</span>, fill <span class="op">=</span> <span class="st">'borough'</span>)) </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add color coded descriptors.</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> geom_histogram(binwidth<span class="op">=</span><span class="dv">1</span>,  <span class="co"># Change width of bins</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>      color <span class="op">=</span> <span class="st">'black'</span>) <span class="co"># Change outline color.</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> theme(axis_text_x<span class="op">=</span>element_text(angle<span class="op">=</span><span class="dv">45</span>)) </span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Change the orientation of the words.</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-48-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="6096f055" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>(ggplot(data_used, aes(x<span class="op">=</span><span class="st">'created_date'</span>, fill <span class="op">=</span> <span class="st">'borough'</span>)) </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add color coded descriptors.</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> geom_histogram(binwidth<span class="op">=</span><span class="dv">1</span>,  <span class="co"># Change width of bins</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>      colour <span class="op">=</span> <span class="st">'black'</span>) <span class="co"># Change outline color.</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> coord_flip() <span class="co"># Change oreintation of graph.</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-49-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>While we’re able to color code the histogram to show other descriptors of the data, another way we can do this with <code>plotnine</code> is through the use of multiple graphs. Using “facet_wrap” we can create a multi facet graph with the same data.</p>
<div id="e3b70cb1" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>(ggplot(data_used, aes(x<span class="op">=</span><span class="st">'created_date'</span>)) </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> geom_histogram(binwidth<span class="op">=</span><span class="dv">1</span>) <span class="co"># Change width of bins</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> facet_wrap(<span class="st">'borough'</span>) <span class="co"># Create multiple graphs.</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> theme(axis_text_x<span class="op">=</span>element_text(angle<span class="op">=</span><span class="dv">45</span>)) </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Change the orientation of the words.</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-50-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="density-plot" class="level4" data-number="8.2.4.4">
<h4 data-number="8.2.4.4" class="anchored" data-anchor-id="density-plot"><span class="header-section-number">8.2.4.4</span> Density Plot</h4>
<p>The last visualization we’re going to look at is density plots. While less common than the graphs previously discussed, density plots show the distribution of a specific variable.</p>
<div id="69f25aec" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>(ggplot(data_used, aes(x<span class="op">=</span><span class="st">'created_date'</span>))</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> geom_density())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-51-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Above we can see a very simple density graph with very little description. Using <code>plotnine</code> we are able to:</p>
<ul>
<li>Add color coded descriptors.</li>
<li>Scale groups by relative size.</li>
<li>Change the orientation of the words on the axes to make them easier to read.</li>
</ul>
<div id="82d2beb9" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>(ggplot(data_used, aes(x<span class="op">=</span><span class="st">'created_date'</span>, color <span class="op">=</span> <span class="st">'descriptor'</span>)) </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>        <span class="co">#Add color coded descriptors.</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> geom_density()</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> theme(axis_text_x<span class="op">=</span>element_text(angle<span class="op">=</span><span class="dv">45</span>)) </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Change the orientation of the words.</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-52-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="814f2602" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>(ggplot(data_used, aes(x<span class="op">=</span><span class="st">'created_date'</span>, color <span class="op">=</span> <span class="st">'descriptor'</span>)) </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>        <span class="co">#Add color coded descriptors.</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> geom_density(aes(y<span class="op">=</span>after_stat(<span class="st">'count'</span>))) </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Scale groups by relative size.</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> theme(axis_text_x<span class="op">=</span>element_text(angle<span class="op">=</span><span class="dv">45</span>)) </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Change the orientation of the words.</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-53-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="resources" class="level3" data-number="8.2.5">
<h3 data-number="8.2.5" class="anchored" data-anchor-id="resources"><span class="header-section-number">8.2.5</span> Resources</h3>
<ul>
<li><a href="https://plotnine.readthedocs.io/en/v0.12.4/gallery.html" class="uri">https://plotnine.readthedocs.io/en/v0.12.4/gallery.html</a></li>
</ul>
</section>
<section id="references-1" class="level3" data-number="8.2.6">
<h3 data-number="8.2.6" class="anchored" data-anchor-id="references-1"><span class="header-section-number">8.2.6</span> References</h3>
<ul>
<li><p>“Plotnine.Geoms.Geom_bar¶.” Plotnine.Geoms.Geom_bar - Plotnine Commit: D1f7dbf Documentation, plotnine.readthedocs.io/en/stable/generated/ plotnine.geoms.geom_bar.html. Accessed 13 Feb.&nbsp;2024.</p></li>
<li><p>“Plotnine.Geoms.Geom_density¶.” Plotnine.Geoms.Geom_density - Plotnine Commit: D1f7dbf Documentation, plotnine.readthedocs.io/en/ stable/generated/plotnine.geoms.geom_density.html. Accessed 17 Feb.&nbsp;2024.</p></li>
<li><p>“Plotnine.Geoms.Geom_histogram¶.” Plotnine.Geoms.Geom_histogram - Plotnine Commit: D1f7dbf Documentation, plotnine.readthedocs.io/en/ stable/generated/plotnine.geoms.geom_histogram.html#plotnine. geoms.geom_histogram. Accessed 17 Feb.&nbsp;2024.</p></li>
<li><p>“Plotnine.Geoms.Geom_point¶.” Plotnine.Geoms.Geom_point - Plotnine Commit: D1f7dbf Documentation, plotnine.readthedocs.io/en/ stable/generated/plotnine.geoms.geom_point.html. Accessed 16 Feb.&nbsp;2024.</p></li>
<li><p>“Plotnine.” PyPI, pypi.org/project/plotnine/. Accessed 13 Feb.&nbsp;2024.</p></li>
<li><p>Sarkar, Dipanjan (DJ). “A Comprehensive Guide to the Grammar of Graphics for Effective Visualization of Multi-Dimensional…” Medium, Towards Data Science, 13 Sept.&nbsp;2018, towardsdatascience.com/a-comprehensive-guide-to-the- grammar-of-graphics-for-effective-visualization-of-multi-dimensional-1f92b4ed4149.</p></li>
</ul>
</section>
</section>
<section id="handling-spatial-data-with-geopandas" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="handling-spatial-data-with-geopandas"><span class="header-section-number">8.3</span> Handling Spatial Data with <code>GeoPandas</code></h2>
<p>This section was written by Pratham Patel.</p>
<section id="introduction-and-installation" class="level3" data-number="8.3.1">
<h3 data-number="8.3.1" class="anchored" data-anchor-id="introduction-and-installation"><span class="header-section-number">8.3.1</span> Introduction and Installation</h3>
<p>Hello! my name is Pratham Patel and I am a Senior due to graduate this semster with a Bachelor’s Degree of Science in Mathematics/Statistics with a Computer Science minor. I hope to gain skills in using various different packages of Python in this course, as well as understand even more about the Data Science field. An example of learning new Python packages is the topic I will present today on the <code>geopandas</code> package. GeoPandas is an extension of the <code>pandas</code> package to support geographic data in its dataframes.</p>
<p>The GeoPandas package can be installed via the terminal using any of the following commands.</p>
<p>The documentation recommends: <code>conda install -c conda-forge geopandas</code></p>
<p>Standard conda install: <code>conda install geopandas</code></p>
<p>Using pip: <code>pip install geopandas</code></p>
</section>
<section id="base-concepts" class="level3" data-number="8.3.2">
<h3 data-number="8.3.2" class="anchored" data-anchor-id="base-concepts"><span class="header-section-number">8.3.2</span> Base Concepts</h3>
<p>GeoPandas relvolves around the <code>GeoDataFrame</code> object, which is essentially the pandas <code>DataFrame</code> object, with all the traditional capabilities in addition to the ability store and operate on geometry columns.</p>
<p>The geometry types include points, lines and closed polygons (the first and last coordinates in the list must be the same).</p>
<p>The objects made by <code>shapely.geometry</code> can represent these geometry types:</p>
<div id="ad4709a4" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> shapely.geometry <span class="im">import</span> Point, LineString, Polygon</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>point <span class="op">=</span> Point(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>gdf1 <span class="op">=</span> gpd.GeoDataFrame(geometry<span class="op">=</span>[point])</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>line <span class="op">=</span> LineString([(<span class="dv">0</span>, <span class="dv">0</span>), (<span class="dv">1</span>, <span class="dv">1</span>)])</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>gdf2 <span class="op">=</span> gpd.GeoDataFrame(geometry<span class="op">=</span>[line])</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="co">#note: the first and last element of </span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="co">#the list of tupled points are the same</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>polygon <span class="op">=</span> Polygon([(<span class="dv">0</span>, <span class="dv">0</span>), (<span class="dv">0</span>, <span class="dv">2</span>), (<span class="dv">2</span>, <span class="dv">2</span>), (<span class="dv">2</span>, <span class="dv">0</span>), (<span class="dv">0</span>, <span class="dv">0</span>)])</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>gdf3 <span class="op">=</span> gpd.GeoDataFrame(geometry<span class="op">=</span>[polygon])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="f7e07cbe" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>gdf1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>POINT (0.00000 1.00000)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Some of the basic attributes of a GeoSeries include: * <code>length</code>: returns length of a line</p>
<div id="b2eb9762" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>gdf2.length</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>0    1.414214
dtype: float64</code></pre>
</div>
</div>
<ul>
<li><code>area</code>: returns the area of the polygon</li>
</ul>
<div id="01bd52cf" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>gdf3.area</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>0    4.0
dtype: float64</code></pre>
</div>
</div>
<ul>
<li><p><code>bounds</code>: gives the bounds of each row in a column of geometry</p></li>
<li><p><code>total_bounds</code>: gives the bounds of a geometry series</p></li>
<li><p><code>geom_type</code>: returns geometry type</p></li>
</ul>
<div id="f717dd3d" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>gdf1.geom_type</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>0    Point
dtype: object</code></pre>
</div>
</div>
<ul>
<li><code>is_valid</code>: return True for valid geometries and false otherwise (mostly important for polygons).</li>
</ul>
<div id="5d4698e0" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>gdf3.is_valid</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>0    True
dtype: bool</code></pre>
</div>
</div>
<p>Next, we will cover various methods to be used on GeoSeries objects:</p>
<ul>
<li><code>distance()</code>: returns the Series with the minimum distance from each entry to another geometry or Series (argument <code>other</code>).
<ul>
<li>Note: a secondary argument <code>align</code> is a boolean to align the GeoSeries by index if set to True</li>
</ul></li>
</ul>
<div id="8345fc74" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>gdf2.distance(Point((<span class="dv">1</span>,<span class="dv">0</span>)))</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>gdf2.distance(LineString([(<span class="dv">0</span>, <span class="dv">2</span>), (<span class="dv">1</span>, <span class="dv">2</span>)]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>0    1.0
dtype: float64</code></pre>
</div>
</div>
<ul>
<li><code>centroid</code>: returns a new GeoSeries with the center of each row’s geometry.</li>
</ul>
<div id="590c15be" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>gdf3.centroid</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>0    POINT (1.00000 1.00000)
dtype: geometry</code></pre>
</div>
</div>
<ul>
<li><code>contains()</code>: returns True if the shape contains a specific geometry or Series.
<ul>
<li>parameters <code>other</code> and <code>align</code></li>
</ul></li>
</ul>
<div id="0343380e" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>gdf3.contains(Point((<span class="fl">0.5</span>, <span class="fl">1.5</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<pre><code>0    True
dtype: bool</code></pre>
</div>
</div>
<div id="6c462ab9" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>gdf3.contains(gdf1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<pre><code>0    False
dtype: bool</code></pre>
</div>
</div>
<ul>
<li><code>intersects()</code> returns true if shape intersects another geometry of series
<ul>
<li>parameters <code>other</code> and <code>align</code></li>
</ul></li>
</ul>
</section>
<section id="reading-files-into-geodataframes" class="level3" data-number="8.3.3">
<h3 data-number="8.3.3" class="anchored" data-anchor-id="reading-files-into-geodataframes"><span class="header-section-number">8.3.3</span> Reading Files into <code>GeoDataFrame</code>’s</h3>
<p>The function <code>geopandas.read_file()</code> is the best way to read a file with both data and geometry into a <code>GeoDataFrame</code> object. From here, we will be using the nyc rodent data and visualize it. The code below converts every incident’s location into a point on the geometry.</p>
<div id="72f7ab62" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reading csv file </span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Shapely for converting latitude/longtitude to a point</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> shapely.geometry <span class="im">import</span> Point </span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="co"># To create GeoDataFrame</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd </span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="co">#read in the feather file as a generic pandas DataFrame</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>rat_22_23 <span class="op">=</span> pd.read_feather(<span class="st">'data/rodent_2022-2023.feather'</span>)</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a><span class="co"># creating geometry using shapely (removing missing points) for the already built in longitude and latitude coordinates</span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>geometry <span class="op">=</span> [Point(xy) <span class="cf">for</span> xy <span class="kw">in</span> <span class="bu">zip</span>(rat_22_23[<span class="st">"longitude"</span>], rat_22_23[<span class="st">"latitude"</span>]) <span class="cf">if</span> <span class="kw">not</span> Point(xy).is_empty]</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a><span class="co"># creating geometry column to be used by geopandas using the points_from_xy method</span></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>geo <span class="op">=</span> gpd.points_from_xy(rat_22_23[<span class="st">"longitude"</span>], rat_22_23[<span class="st">"latitude"</span>])</span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a><span class="co"># coordinate reference system (epsg:4326 implies geographic coordinates)</span></span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>crs <span class="op">=</span> {<span class="st">'init'</span>: <span class="st">'epsg:4326'</span>}</span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a><span class="co"># create GeoDataFrame (takes care of the missing coordinates) </span></span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>rodent_gdf <span class="op">=</span> gpd.GeoDataFrame(rat_22_23.loc[<span class="op">~</span>pd.isna(rat_22_23[<span class="st">"longitude"</span>]) <span class="op">&amp;</span> <span class="op">~</span>pd.isna(rat_22_23[<span class="st">"latitude"</span>])], crs<span class="op">=</span>crs, geometry<span class="op">=</span>geometry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/junyan/work/teaching/ids-s24/ids-s24/.myvenv/lib/python3.12/site-packages/pyproj/crs/crs.py:141: FutureWarning: '+init=&lt;authority&gt;:&lt;code&gt;' syntax is deprecated. '&lt;authority&gt;:&lt;code&gt;' is the preferred initialization method. When making the change, be mindful of axis order changes: https://pyproj4.github.io/pyproj/stable/gotchas.html#axis-order-changes-in-proj-6</code></pre>
</div>
</div>
<p>Here, we can take a view at the new GeoDataFrame:</p>
<div id="c1a16930" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>rodent_gdf.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">unique_key</th>
<th data-quarto-table-cell-role="th">created_date</th>
<th data-quarto-table-cell-role="th">closed_date</th>
<th data-quarto-table-cell-role="th">agency</th>
<th data-quarto-table-cell-role="th">agency_name</th>
<th data-quarto-table-cell-role="th">complaint_type</th>
<th data-quarto-table-cell-role="th">descriptor</th>
<th data-quarto-table-cell-role="th">location_type</th>
<th data-quarto-table-cell-role="th">incident_zip</th>
<th data-quarto-table-cell-role="th">incident_address</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">latitude</th>
<th data-quarto-table-cell-role="th">longitude</th>
<th data-quarto-table-cell-role="th">location</th>
<th data-quarto-table-cell-role="th">zip_codes</th>
<th data-quarto-table-cell-role="th">community_districts</th>
<th data-quarto-table-cell-role="th">borough_boundaries</th>
<th data-quarto-table-cell-role="th">city_council_districts</th>
<th data-quarto-table-cell-role="th">police_precincts</th>
<th data-quarto-table-cell-role="th">police_precinct</th>
<th data-quarto-table-cell-role="th">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>59893776</td>
<td>2023-12-31 23:05:41</td>
<td>2023-12-31 23:05:41</td>
<td>DOHMH</td>
<td>Department of Health and Mental Hygiene</td>
<td>Rodent</td>
<td>Rat Sighting</td>
<td>3+ Family Apt. Building</td>
<td>11216</td>
<td>265 PUTNAM AVENUE</td>
<td>...</td>
<td>40.683857</td>
<td>-73.951645</td>
<td>(40.683855196486164, -73.95164557951071)</td>
<td>17618.0</td>
<td>69.0</td>
<td>2.0</td>
<td>49.0</td>
<td>51.0</td>
<td>51.0</td>
<td>POINT (-73.95164 40.68386)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>59887523</td>
<td>2023-12-31 22:19:22</td>
<td>2024-01-03 08:47:02</td>
<td>DOHMH</td>
<td>Department of Health and Mental Hygiene</td>
<td>Rodent</td>
<td>Rat Sighting</td>
<td>Commercial Building</td>
<td>10028</td>
<td>1538 THIRD AVENUE</td>
<td>...</td>
<td>40.779243</td>
<td>-73.953690</td>
<td>(40.77924175816874, -73.95368859796383)</td>
<td>10099.0</td>
<td>23.0</td>
<td>4.0</td>
<td>1.0</td>
<td>11.0</td>
<td>11.0</td>
<td>POINT (-73.95369 40.77924)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>59891998</td>
<td>2023-12-31 22:03:12</td>
<td>2023-12-31 22:03:12</td>
<td>DOHMH</td>
<td>Department of Health and Mental Hygiene</td>
<td>Rodent</td>
<td>Rat Sighting</td>
<td>3+ Family Apt. Building</td>
<td>10458</td>
<td>2489 TIEBOUT AVENUE</td>
<td>...</td>
<td>40.861694</td>
<td>-73.894989</td>
<td>(40.861693023118924, -73.89499228560491)</td>
<td>10936.0</td>
<td>6.0</td>
<td>5.0</td>
<td>22.0</td>
<td>29.0</td>
<td>29.0</td>
<td>POINT (-73.89499 40.86169)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>59887520</td>
<td>2023-12-31 21:13:02</td>
<td>2024-01-03 09:33:43</td>
<td>DOHMH</td>
<td>Department of Health and Mental Hygiene</td>
<td>Rodent</td>
<td>Mouse Sighting</td>
<td>3+ Family Apt. Building</td>
<td>11206</td>
<td>116 JEFFERSON STREET</td>
<td>...</td>
<td>40.699741</td>
<td>-73.930733</td>
<td>(40.69974221739347, -73.93073474327662)</td>
<td>17213.0</td>
<td>42.0</td>
<td>2.0</td>
<td>30.0</td>
<td>53.0</td>
<td>53.0</td>
<td>POINT (-73.93073 40.69974)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>59889297</td>
<td>2023-12-31 20:50:10</td>
<td>NaT</td>
<td>DOHMH</td>
<td>Department of Health and Mental Hygiene</td>
<td>Rodent</td>
<td>Rat Sighting</td>
<td>1-2 Family Dwelling</td>
<td>11206</td>
<td>114 ELLERY STREET</td>
<td>...</td>
<td>40.698444</td>
<td>-73.948578</td>
<td>(40.69844506428295, -73.94858040356128)</td>
<td>17213.0</td>
<td>69.0</td>
<td>2.0</td>
<td>49.0</td>
<td>51.0</td>
<td>51.0</td>
<td>POINT (-73.94858 40.69844)</td>
</tr>
</tbody>
</table>

<p>5 rows × 48 columns</p>
</div>
</div>
</div>
</div>
</section>
<section id="plotting" class="level3" data-number="8.3.4">
<h3 data-number="8.3.4" class="anchored" data-anchor-id="plotting"><span class="header-section-number">8.3.4</span> Plotting</h3>
<p>The new geometry allows us to plot the data easily.</p>
<div id="089e660e" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">#standard plot of every single rodent incident</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>rodent_gdf.plot()</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="co">#color the plot by borough</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>rodent_gdf.plot(column <span class="op">=</span> <span class="st">'borough'</span>, legend<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="co">#color the plot by borough, with more transparent markers</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>rodent_gdf.plot(column <span class="op">=</span> <span class="st">'borough'</span>, alpha <span class="op">=</span> <span class="fl">0.01</span>)</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a><span class="co">#color by the descriptor of the incident</span></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>rodent_gdf.plot(column <span class="op">=</span> <span class="st">'descriptor'</span>, legend<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot the missing information for borough</span></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>rodent_gdf.plot(column<span class="op">=</span><span class="st">'borough'</span>, missing_kwds<span class="op">=</span>{<span class="st">'color'</span>:<span class="st">'red'</span>})</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a><span class="co">#color the plot by zipcode</span></span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>rodent_gdf.plot(column <span class="op">=</span> <span class="st">'incident_zip'</span>, legend<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-66-output-1.png" width="438" height="411" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-66-output-2.png" width="438" height="411" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-66-output-3.png" width="438" height="411" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-66-output-4.png" width="438" height="411" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-66-output-5.png" width="438" height="411" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-66-output-6.png" width="529" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Note that if an integer column is passed, the legend will present the key as a gradient by default.</p>
<p>You can individualize each zipcode using categorical=True, though be sure the list of unique integers is not too large.</p>
<p><code>rodent_gdf.plot(column = 'incident_zip', legend=True, categorical=True)</code></p>
<p>The geographic visualizations allow us to try to observe some trends amongst the reported rodent incident we see.</p>
</section>
<section id="interactive-maps" class="level3" data-number="8.3.5">
<h3 data-number="8.3.5" class="anchored" data-anchor-id="interactive-maps"><span class="header-section-number">8.3.5</span> Interactive Maps</h3>
<p>A very interesting aspect is the ability to create interactive graphs using the <code>.explore()</code> method.</p>
<p>Note that <code>folium</code>, <code>matplotlib</code>, and <code>mapclassify</code> are necessary for the <code>.explore()</code> function.</p>
<div id="f77e89db" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co">#interactive map with incidents colored by borough</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>rodent_gdf.explore(column<span class="op">=</span><span class="st">'borough'</span>, legend<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>TypeError: Object of type Timestamp is not JSON serializable</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="66">
<pre><code>&lt;folium.folium.Map at 0x12ac8e360&gt;</code></pre>
</div>
</div>
<p>This map lets us specifically find various points and examine them and their surroudings.</p>
</section>
<section id="setting-and-changing-projections" class="level3" data-number="8.3.6">
<h3 data-number="8.3.6" class="anchored" data-anchor-id="setting-and-changing-projections"><span class="header-section-number">8.3.6</span> Setting and Changing Projections</h3>
<p>In the code, a Coordinate Reference System(CRS) was set using <code>crs = {'init':'epsg:4326'}</code>. CRS can be set on on initialized GeoDataFrame using the <code>.set_crs</code> function. We can do this for our previous example <code>gdf3</code>:</p>
<div id="80e31586" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>gdf3 <span class="op">=</span> gdf3.set_crs(<span class="st">"EPSG:4326"</span>)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>gdf3.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="visualization_files/figure-html/cell-68-output-1.png" width="428" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>There are other CRS’s that can be set by the <code>.to_crs()</code> function. Examples include: * ESPG:2263 - coordinates labeled in feet * ESPG:3395 - World Mercator System</p>
</section>
<section id="references-2" class="level3" data-number="8.3.7">
<h3 data-number="8.3.7" class="anchored" data-anchor-id="references-2"><span class="header-section-number">8.3.7</span> References</h3>
<ul>
<li>GeoPandas Documentation:
<ul>
<li>https://geopandas.org/en/stable/index.html</li>
</ul></li>
<li>NYC 311 Service Request
<ul>
<li>https://data.cityofnewyork.us/Social-Services/311-Service-Requests-from-2010-to-Present/erm2-nwe9/about_data</li>
</ul></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./eda.html" class="pagination-link" aria-label="Exploratory Data Analysis">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./statsmod.html" class="pagination-link" aria-label="Statistical Models">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Statistical Models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>